(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[157],{5813:function(e,s,t){Promise.resolve().then(t.bind(t,3297))},3297:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return r},dynamic:function(){return o}});var n=t(9566),a=t(8590),i=t(6555),c=t(4134),l=t(9307);let o="force-dynamic";function r(){let{user:e,loading:s,signOut:t}=(0,l.aC)(),{business:o,loading:r}=(0,l.iF)(),{customers:u,loading:d,refetch:m}=(0,l.n8)(),{services:x,loading:h}=(0,l.Su)(),{createCustomer:f,loading:p}=(0,l.Ad)(),{createQuote:g,loading:j,error:b}=(0,l.i1)(),N=(0,i.useRouter)(),{addToast:v}=(0,c.pm)();(0,a.useEffect)(()=>{s||e||N.push("/")},[e,s,N]),(0,a.useEffect)(()=>{s||r||!e||o||N.push("/onboarding")},[e,s,o,r,N]);let y=async()=>{await t(),N.push("/")},C=async e=>{let s=await f(e);return s&&(await m(),v("success","\uD83D\uDC7B Customer summoned successfully!")),s},w=async e=>{let s=await g({customerId:e.customerId,items:e.items,subtotal:e.subtotal,discountType:e.discountType,discountValue:e.discountValue,total:e.total,notes:e.notes,terms:e.terms,validUntil:e.validUntil});s?(v("success","\uD83C\uDF83 Quote conjured successfully!"),N.push("/quotes/".concat(s.id))):b&&v("error",b.message||"Failed to create quote")};return s||r?(0,n.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,n.jsx)(c.TK,{size:"lg"})}):e&&o?(0,n.jsx)("main",{className:"min-h-screen bg-background p-8",children:(0,n.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("h1",{className:"text-3xl font-bold",children:[(0,n.jsx)("span",{className:"text-halloween-purple",children:"Spooky"}),(0,n.jsx)("span",{className:"text-halloween-orange",children:"Quote"}),(0,n.jsx)("span",{className:"ml-2",children:"\uD83D\uDCF8"})]}),(0,n.jsx)("p",{className:"text-text-muted mt-1",children:o.name})]}),(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)(c.zx,{variant:"ghost",onClick:()=>N.push("/dashboard"),children:"Dashboard"}),(0,n.jsx)(c.zx,{variant:"ghost",onClick:()=>N.push("/quotes"),children:"All Quotes"}),(0,n.jsx)(c.zx,{variant:"ghost",onClick:y,children:"Sign Out"})]})]}),(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-text-primary",children:"Create New Quote"}),(0,n.jsx)("p",{className:"text-text-secondary mt-1",children:"Select a customer and services to generate a professional quote"})]}),(0,n.jsx)(c.zc,{business:o,customers:u,services:x,customersLoading:d,servicesLoading:h,onCreateCustomer:C,onSubmit:w,isSubmitting:j||p})]})}):null}}},function(e){e.O(0,[959,40,696,977,844,560],function(){return e(e.s=5813)}),_N_E=e.O()}]);